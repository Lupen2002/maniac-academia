(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{151:function(e,t,n){e.exports=n(365)},180:function(e,t,n){},181:function(e,t,n){},182:function(e,t,n){},365:function(e,t,n){"use strict";n.r(t);n(152),n(153),n(155);var r=n(0),a=n.n(r),c=n(108),u=n.n(c),i=n(37),o=n.n(i),l=n(56),s=n(61),d=n(18),m=n(2),p=(n(180),n(181),n(74)),f=n(109),E=n.n(f),v=function(e){return new E.a({name:e,prefix:"",modifierDelimiter:"_",outputIsString:!1})},b=v("stub"),k=function(){return r.createElement("div",b(),r.createElement(p.a,Object.assign({},b("spinner"),{icon:"circle-notch",spin:!0,size:"4x"})))},h=function(e){var t=Object({NODE_ENV:"production",PUBLIC_URL:"/maniac-academia",REACT_APP_ADMIN_USER_ID:"10640580"});if("REACT_APP_ADMIN_USER_ID"in t){var n=t.REACT_APP_ADMIN_USER_ID;return!!e&&!!n&&e.id===parseInt(n)}return!1},g=(n(182),n(147)),C=n.n(g),O=n(110),j=n.n(O),A=function(e){var t=e.bem?e.bem("header-context-menu-icon","","Icon"):{};return r.createElement("span",t,r.createElement(p.a,{icon:e.icon}))},x=v("app-header"),w=function(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),a=n[0],c=n[1];return r.createElement(r.Fragment,null,r.createElement(m.PanelHeader,null,e.isAdmin?r.createElement(m.PanelHeaderContent,{aside:r.createElement(C.a,null),onClick:function(){return c(!a)}},e.children):e.children),e.isAdmin&&r.createElement(m.HeaderContext,{opened:a,onClose:function(){}},r.createElement(m.List,null,r.createElement(m.Cell,{onClick:function(){return e.go("events-feed")},asideContent:"events-feed"===e.active?r.createElement(j.a,{fill:"var(--accent)"}):null,before:r.createElement(A,{bem:x,icon:"rss"})},"\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),r.createElement(m.Cell,{onClick:function(){return e.go("events-admin")},before:r.createElement(A,{bem:x,icon:"user-cog"}),asideContent:"events-admin"===e.active?r.createElement(j.a,{fill:"var(--accent)"}):null},"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"))))},y=(v("event-flow"),function(e){return r.createElement(r.Fragment,null,r.createElement(m.Panel,{id:e.id,centered:!e.user},r.createElement(w,{active:e.id,isAdmin:h(e.user),go:e.go},"\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),!e.user&&r.createElement(k,null),h(e.user)&&r.createElement(m.Group,null,r.createElement(m.Div,null,"Admin")),e.user&&!h(e.user)&&r.createElement(m.Group,null,r.createElement(m.Div,null,"User"))))}),S=n(21),I=n.n(S),_=n(38),P=n(148),T=n.n(P),D=n(111);function V(e){for(var t,n={},r=(e+"").split(""),a=[],c=r[0],u=256,i=1;i<r.length;i++)null!=n[c+(t=r[i])]?c+=t:(a.push(c.length>1?n[c]:c.charCodeAt(0)),n[c+t]=u,u++,c=t);a.push(c.length>1?n[c]:c.charCodeAt(0));for(var o=0;o<a.length;o++)a[o]=String.fromCharCode(a[o]);return a.join("")}function N(e){for(var t,n={},r=(e+"").split(""),a=r[0],c=a,u=[a],i=256,o=1;o<r.length;o++){var l=r[o].charCodeAt(0);t=l<256?r[o]:n[l]?n[l]:c+a,u.push(t),a=t.charAt(0),n[i]=c+a,i++,c=t}return u.join("")}var R=function(){var e=Object(_.a)(I.a.mark(function e(t){var n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.send("VKWebAppCallAPIMethod",{method:"storage.get",request_id:"EVENTS",params:{key:"events",global:1,v:"5.101",access_token:t}});case 2:return n=e.sent,e.prev=3,e.abrupt("return",JSON.parse(N(n.data.response)));case 7:return e.prev=7,e.t0=e.catch(3),e.abrupt("return",[]);case 10:case"end":return e.stop()}},e,null,[[3,7]])}));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(_.a)(I.a.mark(function e(t,n){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.send("VKWebAppCallAPIMethod",{method:"storage.set",request_id:"EVENTS",params:{key:"events",global:1,v:"5.101",value:V(JSON.stringify(t)),access_token:n}});case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),U=(v("admin-main"),function(e){var t=r.useState([]),n=Object(d.a)(t,2),a=n[0],c=n[1],u=function(){var t=Object(_.a)(I.a.mark(function t(){var n;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.token){t.next=2;break}throw Error("token is required!");case 2:return t.next=4,R(e.token);case 4:n=t.sent,c(n);case 6:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return Object(r.useEffect)(function(){e.user&&!e.token&&o.a.send("VKWebAppGetAuthToken",{app_id:7062331,scope:"groups,stats"})},[e.user,e.token]),Object(r.useEffect)(function(){e.token&&u()},[e.token]),r.createElement(m.Panel,{id:e.id},r.createElement(w,{active:e.id,isAdmin:h(e.user),go:e.go},"\u0421\u043e\u0431\u044b\u0442\u0438\u044f-\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"),r.createElement(m.Group,null,r.createElement(m.CellButton,{onClick:function(){return e.go("add-events-admin")},before:r.createElement(T.a,null)},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435")),r.createElement(m.Group,null,r.createElement(m.Div,null,JSON.stringify(a))))}),K=n(149),W=n.n(K),J=n(150),q=n.n(J),L=function(e){return r.createElement(m.Tabbar,null,r.createElement(m.TabbarItem,{onClick:function(){return e.go("events")},selected:"events"===e.active,"data-story":"events",text:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f"},r.createElement(W.a,null)),r.createElement(m.TabbarItem,{onClick:function(){return e.go("user")},selected:"user"===e.active,"data-story":"users",text:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"},r.createElement(q.a,null)))},M=n(75),B=function(e){var t=r.useState(""),n=Object(d.a)(t,2),a=n[0],c=n[1],u=r.useState(""),i=Object(d.a)(u,2),o=i[0],l=i[1],s=r.useState(0),p=Object(d.a)(s,2),f=p[0],E=p[1],v=r.useState([]),b=Object(d.a)(v,2),k=b[0],g=b[1],C=function(){var t=Object(_.a)(I.a.mark(function t(){var n,r;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.token){t.next=2;break}throw Error("token is required!");case 2:return n={name:a,price:o,time:f,days:k},t.next=5,R(e.token);case 5:if(r=t.sent,e.token){t.next=8;break}throw Error("token is required!");case 8:return t.next=10,G([].concat(Object(M.a)(r),[n]),e.token);case 10:e.go("events-admin");case 11:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),O=function(e){return function(){var t=Object(_.a)(I.a.mark(function t(n){return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.currentTarget.checked&&!k.includes(e)?g([].concat(Object(M.a)(k),[e])):g(Object(M.a)(k.filter(function(t){return t!==e})));case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},j=function(e){return function(t){switch(e){case"name":return void c(t.currentTarget.value);case"price":var n=t.currentTarget.value;return void(/^\d*$/g.test(n)&&l(n));case"time":return void E(t.currentTarget.value);case"submit":return void C()}}};return r.createElement(m.Panel,{id:e.id},r.createElement(w,{active:e.id,isAdmin:h(e.user),go:e.go},"\u041d\u043e\u0432\u043e\u0435 \u0421\u043e\u0431\u044b\u0442\u0438\u0435"),r.createElement(m.FormLayout,null,r.createElement(m.Input,{type:"text",top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:a,onChange:j("name")}),r.createElement(m.Input,{type:"number",top:"\u0426\u0435\u043d\u0430",value:o,onChange:j("price")}),r.createElement(m.Input,{type:"time",top:"\u0412\u0440\u0435\u043c\u044f",value:f,onChange:j("time")}),r.createElement(m.FormLayoutGroup,{top:"\u041f\u043e\u0432\u0442\u043e\u0440\u044f\u0442\u044c \u043a\u0430\u0436\u0434\u0443\u044e \u043d\u0435\u0434\u0435\u043b\u044e"},r.createElement(m.Checkbox,{checked:k.includes(0),onClick:O(0)},"\u041f\u043d"),r.createElement(m.Checkbox,{checked:k.includes(1),onClick:O(1)},"\u0412\u0442"),r.createElement(m.Checkbox,{checked:k.includes(2),onClick:O(2)},"\u0421\u0440"),r.createElement(m.Checkbox,{checked:k.includes(3),onClick:O(3)},"\u0427\u0442"),r.createElement(m.Checkbox,{checked:k.includes(4),onClick:O(4)},"\u041f\u0442"),r.createElement(m.Checkbox,{checked:k.includes(5),onClick:O(5)},"\u0421\u0431"),r.createElement(m.Checkbox,{checked:k.includes(6),onClick:O(6)},"\u0412\u0441")),r.createElement(m.Button,{size:"xl",onClick:j("submit")},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")),r.createElement(m.Cell,null,r.createElement(m.Div,null,JSON.stringify({price:o,name:a,time:f,days:k}))))},F=function(e){var t=Object(r.useState)("events-feed"),n=Object(d.a)(t,2),a=n[0],c=n[1],u=Object(r.useState)("events"),i=Object(d.a)(u,2),l=i[0],s=i[1],p=Object(r.useState)(null),f=Object(d.a)(p,2),E=f[0],v=f[1],b=Object(r.useState)(null),k=Object(d.a)(b,2),h=k[0],g=k[1];return Object(r.useEffect)(function(){o.a.subscribe(function(e){switch(e.detail.type){case"VKWebAppGetUserInfoResult":v(e.detail.data);break;case"VKWebAppAccessTokenReceived":g(e.detail.data.access_token)}}),o.a.send("VKWebAppGetUserInfo",{})},[]),r.createElement(m.Epic,{activeStory:l,tabbar:r.createElement(L,{active:l,go:s})},r.createElement(m.View,{id:"events",activePanel:a},r.createElement(y,{id:"events-feed",user:E,go:c}),r.createElement(U,{id:"events-admin",token:h,user:E,go:c}),r.createElement(B,{id:"add-events-admin",token:h,user:E,go:c})),r.createElement(m.View,{id:"user",activePanel:"user-main"},r.createElement(m.Panel,{id:"user-main"},r.createElement(m.PanelHeader,null,"\u041a\u0430\u0431\u0438\u043d\u0435\u0442"))))};l.b.add(s.a,s.d,s.c,s.b),o.a.send("VKWebAppInit",{});var H=document.getElementById("root");H&&u.a.render(a.a.createElement(F,null),H)}},[[151,1,2]]]);
//# sourceMappingURL=main.742d4f9c.chunk.js.map